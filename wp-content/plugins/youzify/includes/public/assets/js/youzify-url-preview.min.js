!function(o){"use strict";o(document).ready(function(){o.YOUZIFY_LP={};var n=/((https?|ftp)\:\/\/)?([a-z0-9+!*(),;?&=\$_.-]+(\:[a-z0-9+!*(),;?&=\$_.-]+)?@)?([a-z0-9-.]*)\.([a-z]{2,3})(\:[0-9]{2,5})?(\/([a-z0-9+\$_\-~@\(\)\%]\.?)+)*\/?(\?[a-z+&\$_.-][a-z0-9;:@&#%=+\/\$_.-]*)?(#[a-z_.-][a-z0-9+\$_.-]*)?/i,p=/(https?:\/\/(?:www\.|(?!www))[a-zA-Z0-9][a-zA-Z0-9-]+[a-zA-Z0-9]\.[^\s]{2,}|www\.[a-zA-Z0-9][a-zA-Z0-9-]+[a-zA-Z0-9]\.[^\s]{2,}|https?:\/\/(?:www\.|(?!www))[a-zA-Z0-9]+\.[^\s]{2,}|www\.[a-zA-Z0-9]+\.[^\s]{2,})/gi,e=(Youzify.youzify_url,o("#youzify-wall-form").find(".lp-prepost-container").html());o(document).on("paste",".youzify-wall-textarea",function(e){o.youzify_get_link_preview_data(o(this).closest("form"),o(this).val())}),o(document).on("keyup",".youzify-wall-textarea",function(e){13!=e.which&&32!=e.which&&17!=e.which||o.youzify_get_link_preview_data(o(this).closest("form"),o(this).val())}),o(document).on("keyup",".emojionearea-editor",function(e){o.youzify_get_link_preview_data(o(this).closest("form"),o(this).text())}),o(document).on("change",".lp-preview-no-thubmnail-text input",function(){var e=o(this).closest(".lp-prepost-container");this.checked?e.find(".lp-preview-image").fadeOut(200,function(){e.addClass("youzify-lp-no-thumbnail")}):e.find(".lp-preview-image").fadeIn(200,function(){e.removeClass("youzify-lp-no-thumbnail")})}),o(document).on("click",".lp-button-cancel",function(){o(this).closest(".youzify-lp-prepost").attr("data-loaded",!1),o(this).closest(".lp-prepost-container").fadeOut(200,function(){o(this).html(e).attr("class","lp-prepost-container")})}),o(document).on("click",".lp-preview-title",function(){o(this).fadeOut(200,function(){o(this).closest(".youzify-lp-prepost").find(".lp-preview-replace-title").fadeIn()})}),o(document).on("click",".lp-preview-description",function(){o(this).fadeOut(200,function(){o(this).closest(".youzify-lp-prepost").find(".lp-preview-replace-description").fadeIn()})}),o(document).on("click",".youzify-lp-previous-image",function(){var e=parseInt(o(this).closest(".lp-preview-thubmnail-buttons").attr("data-current"));e<1||o.youzify_update_live_preview_image(o(this).closest(".youzify-lp-prepost"),e-1)}),o(document).on("click",".youzify-lp-next-image",function(){var e=parseInt(o(this).closest(".lp-preview-thubmnail-buttons").attr("data-current"))+1;o.YOUZIFY_LP.images[e]&&o.youzify_update_live_preview_image(o(this).closest(".youzify-lp-prepost"),e)}),o.youzify_update_live_preview_image=function(e,i){e.find('input[name="url_preview_img"]').val(o.YOUZIFY_LP.images[i]),e.find(".lp-preview-image").css("background-image","url("+o.YOUZIFY_LP.images[i]+")"),e.find(".lp-preview-thubmnail-buttons").attr("data-current",i),e.find(".lp-preview-pagination").find(".lp-preview-thubmnail-pagination").text(i+1)},o.youzify_get_link_preview_data=function(i,e){if("activity_comment"!=i.find('input[name="post_type"]').val()&&"true"!=i.find(".youzify-lp-prepost").attr("data-loaded")&&""!=e&&(t=e,n.test(t))){var t,a=e.match(n);new RegExp(p).test(a[0])&&(i.find(".youzify-wall-post, .youzify-update-post").attr("disabled",!0),i.find(".lp-loading-text").fadeIn(),i.find(".youzify-lp-prepost").attr("data-loaded",!0),o.ajax({url:ajaxurl,method:"POST",data:{action:"youzify_get_url_live_preview",text:e},headers:{"Content-Type":"application/x-www-form-urlencoded"},success:function(e){e=o.parseJSON(e),o.youzify_set_live_preview_form(i.find(".youzify-lp-prepost"),e),i.find(".youzify-wall-post, .youzify-update-post").attr("disabled",!1)}}))}}}),o.youzify_set_live_preview_form=function(e,i){var n=e.find(".lp-prepost-container"),t={"{{preview.title}}":i.title,"{{preview.site}}":i.site,"{{preview.description}}":i.description,"{{preview.image}}":i.image,"{{thumbnailPaginationText}}":1,"{{thumbnailText}}":i.images?i.images.length:1};o.YOUZIFY_LP.images=i.images,i.image&&e.find(".lp-preview-image").css("background-image","url("+i.image+")").prepend('<input type="hidden" name="url_preview_img" value="'+i.image+'">'),i.link&&e.find(".lp-preview-image").prepend('<input type="hidden" name="url_preview_link" value="'+i.link+'">'),i.site&&e.find(".lp-preview-image").prepend('<input type="hidden" name="url_preview_site" value="'+i.site+'">'),i.title&&e.find(".lp-preview-replace-title-wrap").append('<input type="text" class="lp-preview-replace-title" name="url_preview_title" value="'+i.title+'">'),i.description&&e.find(".lp-preview-replace-description-wrap").append('<textarea name="url_preview_desc" class="lp-no-resize lp-preview-replace-description">'+i.description+"</textarea>"),i.images&&i.images.length<2?n.find(".lp-preview-pagination").remove():n.find(".lp-preview-thubmnail-buttons").attr("data-current",0),0==i.video&&n.find(".lp-preview-video-icon").remove(),o.each(t,function(e,i){var t=new RegExp(e,"g"),a=n.html().replace(t,i);n.html(a)}),i.use_thumbnail&&"on"==i.use_thumbnail&&n.find('input[name="url_preview_use_thumbnail"]').attr("checked",!0).trigger("change"),e.find(".lp-loading-text").fadeOut(200,function(){n.fadeIn()})}}(jQuery);